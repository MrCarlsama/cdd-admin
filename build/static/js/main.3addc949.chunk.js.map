{"version":3,"sources":["reportWebVitals.ts","utils/api.ts","context/authContext.tsx","utils/http.ts","utils/useOpimisticOptions.ts","screens/artists/model.ts","utils/url.ts","utils/index.ts","screens/artists/util.ts","screens/artists/artistModal.tsx","screens/artists/artistsList.tsx","screens/artists/searchPanel.tsx","screens/artists/index.tsx","screens/photos/model.ts","components/artistSelect.tsx","screens/photos/util.ts","screens/photos/index.tsx","screens/photos/waitAuditPhotos.tsx","screens/index/util.ts","components/lib.tsx","screens/index/login.tsx","screens/index/index.tsx","App.tsx","context/index.tsx","index.tsx"],"names":["reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","API_URL","LOCAL_STORAGE_KEY","handleUserResponse","user","window","localStorage","setItem","JSON","stringify","logoutHandle","a","removeItem","AuthContext","React","createContext","undefined","displayName","AuthProvider","children","useState","setUser","queryClient","useQueryClient","Provider","value","logout","clear","useRegister","http","useHttp","useMutation","data","method","useLogin","useAuth","context","useContext","Error","API_HOST","process","apiUrl","token","headers","customConfig","config","Authorization","toUpperCase","qs","body","fetch","res","json","isSuccess","code","Promise","reject","error","useCallback","useConfig","queryKey","callback","onSuccess","invalidateQueries","onMutate","target","previousItems","getQueryData","setQueryData","old","onError","newItem","useQueryDeleteConfig","filter","item","id","useQueryEditConfig","map","useAddArtists","params","useQueryAddConfig","useEditArtists","useArtists","param","artistsList","handle","length","useQuery","useUrlQueryParam","keys","useSearchParams","searchParams","setSearchParam","useSetUrlSearchParam","stateKeys","useMemo","obj","filteredEntries","Object","entries","key","includes","fromEntries","subset","o","object","result","forEach","cleanObject","useArtistsSearchParams","setParam","useArtistsQueryKey","useArtistModal","artistCreate","setArtistCreate","editingArtistId","setEditingArtistId","setUrlParams","enabled","useArtist","Number","artistModalOpen","open","message","close","startEdit","editingArtist","isLoading","ArtistModal","mutateAsync","mutateLoading","useForm","form","closeModal","resetFields","title","useEffect","setFieldsValue","forceRender","onClose","width","visible","size","gutter","span","layout","onFinish","values","Item","label","name","rules","required","placeholder","style","textAlign","loading","type","htmlType","ArtistsList","props","rowKey","pagination","columns","dataIndex","render","artist","createDate","dayjs","format","StatusIcon","isAudit","status","CheckCircleOutlined","color","CloseCircleOutlined","More","deleteProject","useDeleteArtists","mutate","editArtistHandle","editArtist","overlay","onClick","Modal","confirm","content","okText","cancelText","onOk","SearchPanel","align","wrap","onChange","evt","ArtistsScreen","delay","debounceValue","setDebounceValue","timeout","setTimeout","clearTimeout","useDebounce","artists","dataSource","position","Container","styled","div","usePhotos","toNumber","isNaN","ArtistSelect","restProps","mode","allowClear","toNumberArray","filterOption","input","option","toLowerCase","indexOf","Option","usePhotosParams","paramData","usePhotosQueryKey","useDeletePhotosHandle","deleteHandle","useDeletePhotos","GridContainer","photos","photo","xs","sm","md","lg","CardContainer","hoverable","cover","ImageWrap","src","url","SearchContainer","useExportPhotos","exportHandle","notification","success","duration","btn","location","href","artistIds","options","block","icon","DownloadOutlined","PhotosScreen","limit","skip","toString","pre","ReloadOutlined","photoIdx","selectArtistsIds","handleSetSelectArtistsIds","deletePhotosHandle","actions","Text","description","val","WaitAuditPhotosScreen","gettingLoading","setSelectArtistsIds","artistsIds","ids","index","idsList","splice","useCardImageSelect","auditList","useAuditPhotos","editingLoading","handleAudit","list","warning","useLoginModal","login","setLogin","loginModalOpen","ErrorBox","LoginModal","username","password","placement","Sider","routeType","units","useLocation","pathname","split","useRouteType","breakpoint","collapsedWidth","padding","UserOutlined","theme","selectedKeys","HeartOutlined","to","TeamOutlined","UsergroupAddOutlined","Content","margin","display","backgroundColor","flex","path","element","Footer","Main","minHeight","IndexScreen","document","App","className","AppProviders","QueryClient","QueryClientProvider","client","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.3addc949.chunk.js","sourcesContent":["import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","export const API_URL = {\n  Artist: \"/cdd/artists\",\n  Photos: \"/cdd/photos\",\n  Nicknames: \"/cdd/nicknames\",\n  Users: \"/users\",\n};\n","import React, { ReactNode, useState } from \"react\";\nimport { UseMutationResult, useQueryClient } from \"react-query\";\nimport { Users } from \"types/users\";\nimport { useMutation } from \"react-query\";\nimport { API_URL } from \"utils/api\";\nimport { useHttp } from \"utils/http\";\n\nconst LOCAL_STORAGE_KEY = \"__user_info__\";\n\nconst handleUserResponse = (user: Users) => {\n  window.localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(user) || \"\");\n  return user;\n};\n\ntype AuthForm = { username: string; password: string };\n\nconst logoutHandle = async () =>\n  window.localStorage.removeItem(LOCAL_STORAGE_KEY);\n\nconst AuthContext = React.createContext<\n  | {\n      user: Users | null;\n      logout: () => Promise<void>;\n      useLogin: () => UseMutationResult<void, unknown, AuthForm, unknown>;\n      useRegister: () => UseMutationResult<void, unknown, AuthForm, unknown>;\n    }\n  | undefined\n>(undefined);\n\nAuthContext.displayName = \"AuthContext\";\n\nexport const AuthProvider = ({ children }: { children: ReactNode }) => {\n  const [user, setUser] = useState<Users | null>(null);\n  const queryClient = useQueryClient();\n\n  const logout = () =>\n    logoutHandle().then(() => {\n      setUser(null);\n      queryClient.clear();\n    });\n\n  const useRegister = () => {\n    const http = useHttp();\n    return useMutation((data: AuthForm) =>\n      http(`${API_URL.Users}/login`, {\n        data,\n        method: \"POST\",\n      })\n        .then(handleUserResponse)\n        .then(setUser)\n    );\n  };\n\n  const useLogin = () => {\n    const http = useHttp();\n\n    return useMutation((data: AuthForm) =>\n      http(`${API_URL.Users}/login`, {\n        data,\n        method: \"POST\",\n      })\n        .then(handleUserResponse)\n        .then(setUser)\n    );\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{ user, logout, useRegister, useLogin }}\n      children={children}\n    />\n  );\n};\n\nexport const useAuth = () => {\n  const context = React.useContext(AuthContext);\n  if (!context) {\n    throw new Error(\"useAuth must be used in AuthProvider\");\n  }\n\n  return context;\n};\n","import { useAuth } from \"context/authContext\";\nimport qs from \"qs\";\nimport { useCallback } from \"react\";\n\nconst API_HOST = process.env.REACT_APP_API_HOST;\n\ninterface Config extends RequestInit {\n  token?: string;\n  data?: object;\n}\n\nconst http = async (\n  apiUrl: string,\n  { data, token, headers, ...customConfig }: Config = {}\n) => {\n  const config = {\n    method: \"GET\",\n    headers: {\n      Authorization: token ? `Bearer ${token}` : \"\",\n      \"Content-Type\": data ? \"application/json\" : \"\",\n    },\n    ...customConfig,\n  };\n\n  // 处理url 和 body\n  if (config.method.toUpperCase() === \"GET\") {\n    apiUrl += `?${qs.stringify(data)}`;\n  } else {\n    config.body = JSON.stringify(data || {});\n  }\n\n  return window.fetch(`${API_HOST}/api${apiUrl}`, config).then(async (res) => {\n    const data = await res.json();\n    if (data.isSuccess) {\n      return data.data;\n    } else {\n      if (data.code === 401) {\n        useAuth().logout();\n        return Promise.reject(\"权限不足或过期\");\n      } else {\n        return Promise.reject(data.error);\n      }\n    }\n  });\n};\n\nexport const useHttp = () => {\n  const { user } = useAuth();\n  return useCallback(\n    // (...[apiUrl, config]: Parameters<typeof http>) =>\n    (apiUrl: string, config: Config = {}) =>\n      http(apiUrl, { ...config, token: user?.token }),\n    [user?.token]\n  );\n};\n","import { QueryKey, useQueryClient } from \"react-query\";\n\n// react-query 乐观更新 config\nexport const useConfig = (\n  queryKey: QueryKey,\n  callback: (target: any, old?: any[]) => any[]\n) => {\n  const queryClient = useQueryClient();\n\n  return {\n    onSuccess: () => queryClient.invalidateQueries(queryKey),\n    onMutate(target: any) {\n      // 获取之前数据快照\n      const previousItems = queryClient.getQueryData(queryKey);\n\n      queryClient.setQueryData(queryKey, (old?: any[]) => {\n        return callback(target, old);\n      });\n\n      // 返回快照上下文，给错误回退用\n      return { previousItems };\n    },\n    onError(error: any, newItem: any, context: any) {\n      queryClient.setQueryData(queryKey, context.previousItems);\n    },\n  };\n};\nexport const useQueryDeleteConfig = (queryKey: QueryKey) =>\n  useConfig(\n    queryKey,\n    (target, old) => old?.filter((item) => item.id !== target.id) || []\n  );\n\nexport const useQueryEditConfig = (queryKey: QueryKey) =>\n  useConfig(\n    queryKey,\n    (target, old) =>\n      old?.map((item) =>\n        item.id === target.id ? { ...item, ...target } : item\n      ) || []\n  );\n\nexport const useQueryAddConfig = (queryKey: QueryKey) =>\n  useConfig(queryKey, (target, old) => (old ? [...old, target] : []));\n","import { QueryKey, useMutation, useQuery, useQueryClient } from \"react-query\";\nimport { Artists } from \"types/artists\";\nimport { API_URL } from \"utils/api\";\nimport { useHttp } from \"utils/http\";\nimport {\n  useQueryAddConfig,\n  useQueryDeleteConfig,\n  useQueryEditConfig,\n} from \"utils/useOpimisticOptions\";\n\n// 增\nexport const useAddArtists = (queryKey: QueryKey) => {\n  const http = useHttp();\n  return useMutation(\n    (params: Partial<Artists>) =>\n      http(API_URL.Artist, {\n        data: params,\n        method: \"POST\",\n      }),\n    useQueryAddConfig(queryKey)\n  );\n};\n\n// 删\nexport const useDeleteArtists = (queryKey: QueryKey) => {\n  const http = useHttp();\n  return useMutation(\n    (params: Partial<Artists>) =>\n      http(`${API_URL.Artist}/${params.id}`, {\n        data: params,\n        method: \"DELETE\",\n      }),\n    useQueryDeleteConfig(queryKey)\n  );\n};\n\n// 改\nexport const useEditArtists = (queryKey: QueryKey) => {\n  const http = useHttp();\n  return useMutation(\n    (params: Partial<Artists>) =>\n      http(`${API_URL.Artist}/${params.id}`, {\n        data: params,\n        method: \"PATCH\",\n      }),\n    useQueryEditConfig(queryKey)\n  );\n};\n\n// 查\nexport const useArtists = (param?: Partial<Artists>) => {\n  const queryClient = useQueryClient();\n\n  const artistsList: Artists[] =\n    queryClient.getQueryData([\"artists\", param]) || [];\n\n  const handle =\n    artistsList.length > 0\n      ? () => artistsList\n      : () => http(API_URL.Artist, { data: param });\n\n  const http = useHttp();\n\n  return useQuery<Artists[]>([\"artists\", param], () =>\n    // http(API_URL.Artist, { data: param })\n    handle()\n  );\n};\n\n// 查 - single\nexport const useArtist = (id: number) => {\n  const http = useHttp();\n\n  return useQuery<Artists>(\n    [\"artist\", { id }],\n    () => http(`${API_URL.Artist}/${id}`),\n    {\n      enabled: !!id,\n    }\n  );\n};\n","import { subset } from \"./index\";\nimport { cleanObject } from \"utils\";\nimport { useMemo, useState } from \"react\";\nimport { URLSearchParamsInit, useSearchParams } from \"react-router-dom\";\n\n/**\n * 返回页面URL中，指点键的参数值\n */\nexport const useUrlQueryParam = <K extends string>(keys: K[]) => {\n  const [searchParams] = useSearchParams();\n  const setSearchParam = useSetUrlSearchParam();\n  const [stateKeys] = useState(keys);\n\n  return [\n    useMemo(\n      () =>\n        subset(Object.fromEntries(searchParams), stateKeys) as {\n          [key in K]: string;\n        },\n      [searchParams, stateKeys]\n    ),\n    (params: Partial<{ [key in K]: unknown }>) => {\n      return setSearchParam(params);\n    },\n  ] as const;\n};\n\nexport const useSetUrlSearchParam = () => {\n  const [searchParams, setSearchParam] = useSearchParams();\n  return (params: { [key in string]: unknown }) => {\n    const o = cleanObject({\n      ...Object.fromEntries(searchParams),\n      ...params,\n    }) as URLSearchParamsInit;\n    return setSearchParam(o);\n  };\n};\n","import { useEffect, useState } from \"react\";\n\n/**\n * 防抖hooks\n */\nexport const useDebounce = <V>(value: V, delay?: number) => {\n  const [debounceValue, setDebounceValue] = useState(value);\n\n  useEffect(() => {\n    const timeout = setTimeout(() => setDebounceValue(value), delay);\n\n    return () => clearTimeout(timeout);\n  }, [value, delay]);\n\n  return debounceValue;\n};\n\n/**\n * 传入一个对象，和键集合，返回对应的对象中的键值对\n */\nexport const subset = <\n  O extends { [key in string]: unknown },\n  K extends keyof O\n>(\n  obj: O,\n  keys: K[]\n) => {\n  const filteredEntries = Object.entries(obj).filter(([key]) =>\n    keys.includes(key as K)\n  );\n  return Object.fromEntries(filteredEntries) as Pick<O, K>;\n};\n\nexport const isVoid = (value: unknown) =>\n  value === undefined || value === null || value === \"\";\n\n/**\n * 清除对象内空值\n */\nexport const cleanObject = (object: { [key: string]: unknown }) => {\n  const result = { ...object };\n  Object.keys(result).forEach((key) => {\n    const value = result[key];\n    if (isVoid(value)) {\n      delete result[key];\n    }\n  });\n  return result;\n};\n","import { useArtist } from \"./model\";\nimport { useMemo } from \"react\";\nimport { useSetUrlSearchParam, useUrlQueryParam } from \"./../../utils/url\";\nimport { useAuth } from \"context/authContext\";\nimport { message } from \"antd\";\n\n/**\n *  返回Url搜索参数\n */\nexport const useArtistsSearchParams = () => {\n  const [param, setParam] = useUrlQueryParam([\"name\"]);\n\n  return [useMemo(() => ({ ...param }), [param]), setParam] as const;\n};\n\n/**\n * ReactQuery Key\n */\nexport const useArtistsQueryKey = () => {\n  const [param] = useArtistsSearchParams();\n\n  return [\"artists\", param];\n};\n\n/**\n * 模态框\n */\nexport const useArtistModal = () => {\n  // 从url获取参数\n  const [{ artistCreate }, setArtistCreate] = useUrlQueryParam([\n    \"artistCreate\",\n  ]);\n\n  const [{ editingArtistId }, setEditingArtistId] = useUrlQueryParam([\n    \"editingArtistId\",\n  ]);\n\n  const { user } = useAuth();\n  const setUrlParams = useSetUrlSearchParam();\n\n  const { data: editingArtist, isLoading } = useArtist(Number(editingArtistId));\n  const open = () => {\n    if (!user) {\n      message.error(\"没有权限哟~\");\n      return;\n    }\n    return setArtistCreate({ artistCreate: true });\n  };\n  const close = () => setUrlParams({ artistCreate: \"\", editingArtistId: \"\" });\n  const startEdit = (id: number) => setEditingArtistId({ editingArtistId: id });\n\n  return {\n    artistModalOpen: artistCreate === \"true\" || !!editingArtistId,\n    open,\n    close,\n    startEdit,\n    editingArtist,\n    isLoading,\n  };\n};\n","import { Form, Drawer, Row, Input, Button, Spin, Col } from \"antd\";\nimport { useForm } from \"antd/lib/form/Form\";\nimport { useEffect } from \"react\";\nimport { useAddArtists, useEditArtists } from \"./model\";\nimport { useArtistModal, useArtistsQueryKey } from \"./util\";\n\nexport const ArtistModal = () => {\n  const { artistModalOpen, close, editingArtist, isLoading } = useArtistModal();\n\n  const useMutateArtist = editingArtist ? useEditArtists : useAddArtists;\n\n  // 更新数据\n  const { mutateAsync, isLoading: mutateLoading } = useMutateArtist(\n    useArtistsQueryKey()\n  );\n\n  const [form] = useForm();\n\n  // 提交表单\n  const onFinish = (values: any) => {\n    mutateAsync({\n      ...editingArtist,\n      ...values,\n    }).then(() => {\n      closeModal();\n    });\n  };\n\n  // 关闭模态框\n  const closeModal = () => {\n    form.resetFields();\n    close();\n  };\n  const title = editingArtist ? \"编辑声优\" : \"新建声优\";\n\n  // 设置初始化值\n  useEffect(() => {\n    form.setFieldsValue(editingArtist);\n  }, [editingArtist, form]);\n\n  return (\n    <Drawer\n      forceRender={true}\n      title={title}\n      onClose={closeModal}\n      width={\"40%\"}\n      visible={artistModalOpen}\n    >\n      {isLoading ? (\n        <Spin size={\"large\"} />\n      ) : (\n        <Row gutter={[16, 16]}>\n          <Col span={24}>\n            <Form form={form} layout={\"vertical\"} onFinish={onFinish}>\n              <Form.Item\n                label={\"名称\"}\n                name={\"name\"}\n                rules={[\n                  {\n                    required: true,\n                    message: \"请输入名称\",\n                  },\n                ]}\n              >\n                <Input placeholder={\"请输入名称\"} />\n              </Form.Item>\n              <Form.Item label={\"原名称\"} name={\"nameJA\"}>\n                <Input placeholder={\"请输入原名称\"} />\n              </Form.Item>\n              <Form.Item\n                label={\"罗马音\"}\n                name={\"nameRoma\"}\n                rules={[\n                  {\n                    required: true,\n                    message: \"请输入罗马音\",\n                  },\n                ]}\n              >\n                <Input placeholder={\"请输入罗马音\"} />\n              </Form.Item>\n              <Form.Item style={{ textAlign: \"right\" }}>\n                <Button\n                  loading={mutateLoading}\n                  type={\"primary\"}\n                  htmlType={\"submit\"}\n                >\n                  提交\n                </Button>\n              </Form.Item>\n            </Form>\n          </Col>\n        </Row>\n      )}\n    </Drawer>\n  );\n};\n","import {\n  Button,\n  Dropdown,\n  Menu,\n  message,\n  Modal,\n  Table,\n  TableProps,\n} from \"antd\";\nimport { Artists } from \"types/artists\";\nimport { useDeleteArtists } from \"./model\";\nimport { useArtistModal, useArtistsQueryKey } from \"./util\";\nimport { CloseCircleOutlined, CheckCircleOutlined } from \"@ant-design/icons\";\nimport dayjs from \"dayjs\";\nimport { useAuth } from \"context/authContext\";\n\nexport const ArtistsList = ({ ...props }: TableProps<Artists>) => {\n  return (\n    <Table\n      rowKey={\"id\"}\n      pagination={false}\n      columns={[\n        { title: \"名称\", dataIndex: \"name\" },\n        { title: \"罗马音\", dataIndex: \"nameRoma\" },\n        {\n          title: \"创建时间\",\n          render(value, artist) {\n            return (\n              <span>\n                {artist.createDate\n                  ? dayjs(artist.createDate).format(\"YYYY-MM-DD HH:mm:ss\")\n                  : \"无\"}\n              </span>\n            );\n          },\n        },\n        {\n          title: \"审核状态\",\n          render: (value, artist) => StatusIcon(artist.isAudit),\n        },\n        {\n          title: \"启禁用状态\",\n          render: (value, artist) => StatusIcon(artist.status),\n        },\n        {\n          render(value, artist) {\n            return <More artist={artist} />;\n          },\n        },\n      ]}\n      {...props}\n    />\n  );\n};\n\n// 状态icon\nconst StatusIcon = (status: boolean) => {\n  return status ? (\n    <CheckCircleOutlined style={{ color: \"#73d13d\" }} />\n  ) : (\n    <CloseCircleOutlined style={{ color: \"#ff4d4f\" }} />\n  );\n};\n\n// 更多\nconst More = ({ artist }: { artist: Artists }) => {\n  const { startEdit } = useArtistModal();\n  const editArtist = (id: number) => startEdit(id);\n\n  const { user } = useAuth();\n\n  const { mutate: deleteProject } = useDeleteArtists(useArtistsQueryKey());\n\n  const confirmDeleteArtist = (id: number) => {\n    if (!user) {\n      message.error(\"没有权限哟~\");\n      return;\n    }\n    Modal.confirm({\n      title: \"确定删除这个项目吗？\",\n      content: \"点击确定删除\",\n      okText: \"确定\",\n      cancelText: \"取消\",\n      onOk() {\n        deleteProject({ id });\n      },\n    });\n  };\n\n  const editArtistHandle = (id: number) => {\n    if (!user) {\n      message.error(\"没有权限哟~\");\n      return;\n    }\n    editArtist(id);\n  };\n\n  return (\n    <Dropdown\n      overlay={\n        <Menu>\n          <Menu.Item onClick={() => editArtistHandle(artist.id)} key={\"edit\"}>\n            编辑\n          </Menu.Item>\n          <Menu.Item\n            key={\"delete\"}\n            onClick={() => confirmDeleteArtist(artist.id)}\n          >\n            删除\n          </Menu.Item>\n        </Menu>\n      }\n    >\n      <Button type={\"link\"}>...</Button>\n    </Dropdown>\n  );\n};\n","import { Input, Space } from \"antd\";\nimport { Artists } from \"types/artists\";\n\nexport interface SearchPanelProps {\n  param: Partial<Pick<Artists, \"name\">>;\n  setParam: (param: SearchPanelProps[\"param\"]) => void;\n}\n\nexport const SearchPanel = ({ param, setParam }: SearchPanelProps) => {\n  return (\n    <Space align={\"center\"} wrap={true}>\n      <Input\n        placeholder={\"名字\"}\n        type={\"text\"}\n        value={param.name}\n        onChange={(evt) => setParam({ ...param, name: evt.target.value })}\n      />\n    </Space>\n  );\n};\n","import styled from \"@emotion/styled\";\nimport { Button, Col, Row } from \"antd\";\nimport { useDebounce } from \"utils\";\nimport { ArtistModal } from \"./artistModal\";\nimport { ArtistsList } from \"./artistsList\";\nimport { useArtists } from \"./model\";\nimport { SearchPanel } from \"./searchPanel\";\nimport { useArtistModal, useArtistsSearchParams } from \"./util\";\n\nexport const ArtistsScreen = () => {\n  const [param, setParam] = useArtistsSearchParams();\n  const { data: artists, isLoading } = useArtists(useDebounce(param, 200));\n\n  const { open } = useArtistModal();\n\n  return (\n    <Container>\n      <Row gutter={[16, 16]}>\n        <Col span={24}>\n          <SearchPanel param={param} setParam={setParam} />\n        </Col>\n        <Col span={24}>\n          <Button type=\"primary\" onClick={open}>\n            新建声优\n          </Button>\n        </Col>\n        <Col span={24}>\n          <ArtistsList\n            loading={isLoading}\n            dataSource={artists || []}\n            style={{ width: \"100%\" }}\n            pagination={{ position: [\"bottomRight\"] }}\n          />\n        </Col>\n      </Row>\n\n      <ArtistModal />\n    </Container>\n  );\n};\n\nconst Container = styled.div`\n  height: 100%;\n`;\n","import {\n  useQueryDeleteConfig,\n  useQueryEditConfig,\n} from \"utils/useOpimisticOptions\";\nimport { useHttp } from \"utils/http\";\nimport { Photos } from \"types/photos\";\nimport { API_URL } from \"utils/api\";\nimport { QueryKey, useMutation, useQuery } from \"react-query\";\nimport { Pageination } from \"types\";\n\n// 查\nexport const usePhotos = (param?: Pageination<Partial<Photos>>) => {\n  const http = useHttp();\n\n  return useQuery<Photos[]>([\"photos\", param], () =>\n    http(API_URL.Photos, { data: param })\n  );\n};\n\n// 批量审核\nexport const useAuditPhotos = (queryKey: QueryKey) => {\n  const http = useHttp();\n\n  return useMutation(\n    (auditList: { id: number; artistIds: number[] }[]) =>\n      http(`${API_URL.Photos}/audit`, {\n        data: auditList,\n        method: \"POST\",\n      }),\n    useQueryEditConfig(queryKey)\n  );\n};\n\n// 删\nexport const useDeletePhotos = (queryKey: QueryKey) => {\n  const http = useHttp();\n  return useMutation(\n    (params: Partial<Photos>) =>\n      http(`${API_URL.Photos}/${params.id}`, {\n        data: params,\n        method: \"DELETE\",\n      }),\n    useQueryDeleteConfig(queryKey)\n  );\n};\n\n// 导出\nexport const useExportPhotos = () => {\n  const http = useHttp();\n  return useMutation((param: { artistIds: number[] }) =>\n    http(`${API_URL.Photos}/export`, {\n      data: param,\n      method: \"POST\",\n    })\n  );\n  // return http(`${API_URL.Photos}/export`, {\n  //   data: param,\n  //   method: \"POST\",\n  // });\n};\n","import { Select } from \"antd\";\nimport React from \"react\";\nimport { useArtists } from \"screens/artists/model\";\n\ntype SelectProps = React.ComponentProps<typeof Select>;\n\ninterface ArtistSelectProps extends Omit<SelectProps, \"value\" | \"onChange\"> {\n  value: number[] | null | undefined;\n  onChange: (values: number[]) => void;\n}\n\nconst toNumber = (value: unknown) => (isNaN(Number(value)) ? 0 : Number(value));\n\nconst toNumberArray = (values: any) =>\n  values.map((value: unknown) => toNumber(value));\n\nexport const ArtistSelect = (props: ArtistSelectProps) => {\n  const { value: values, onChange, ...restProps } = props;\n\n  const { data: artists = [] } = useArtists();\n\n  return (\n    <Select\n      mode=\"multiple\"\n      placeholder={\"声优\"}\n      allowClear\n      value={values?.map((value) => toNumber(value))}\n      onChange={(values) => onChange(toNumberArray(values))}\n      filterOption={(input, option) =>\n        option?.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\n      }\n      {...restProps}\n    >\n      {artists.map((artist) => (\n        <Select.Option key={artist.id} value={artist.id}>\n          {artist.name}\n        </Select.Option>\n      ))}\n    </Select>\n  );\n};\n","import { Photos } from \"types/photos\";\nimport { useEffect, useMemo, useState } from \"react\";\nimport { Pageination } from \"types\";\nimport { useDeletePhotos } from \"./model\";\nimport { message, Modal } from \"antd\";\nimport { useAuth } from \"context/authContext\";\n\nexport type PhotoParamType = Pageination<\n  Partial<Photos & { artistIds: number[] }>\n>;\n\n/**\n *  返回参数\n */\nexport const usePhotosParams = (paramData: PhotoParamType) => {\n  const [param, setParam] = useState(paramData);\n\n  return [useMemo(() => ({ ...param }), [param]), setParam] as const;\n};\n\n/**\n * ReactQuery Key\n */\nexport const usePhotosQueryKey = (paramData: PhotoParamType) => {\n  const [param] = usePhotosParams(paramData);\n\n  return [\"photos\", param];\n};\n\nexport const useCardImageSelect = (photos: Photos[]) => {\n  // 获取下拉框的值\n  const [selectArtistsIds, setSelectArtistsIds] = useState<number[][]>([]);\n\n  useEffect(() => {\n    const artistsIds = photos.map((photo) =>\n      photo.artists.map((artist) => artist.id)\n    );\n    setSelectArtistsIds(artistsIds);\n  }, [photos]);\n\n  const handleSetSelectArtistsIds = (ids: number[], index: number) => {\n    const idsList = [...selectArtistsIds];\n\n    idsList.splice(index, 1, ids);\n\n    setSelectArtistsIds(idsList);\n  };\n\n  return [selectArtistsIds, handleSetSelectArtistsIds] as const;\n};\n\nexport const useDeletePhotosHandle = (param: PhotoParamType) => {\n  const { user } = useAuth();\n\n  const { mutateAsync: deleteHandle } = useDeletePhotos(\n    usePhotosQueryKey(param)\n  );\n\n  return (id: number) => {\n    if (!user) {\n      message.error(\"没有权限哟~\");\n      return;\n    }\n    Modal.confirm({\n      okText: \"确定\",\n      cancelText: \"取消\",\n      title: \"确定删除图片吗？\",\n      onOk() {\n        return deleteHandle({ id });\n      },\n    });\n  };\n};\n","import {\n  Button,\n  Card,\n  Col,\n  Image,\n  message,\n  notification,\n  Row,\n  Space,\n  Spin,\n  Tag,\n} from \"antd\";\nimport { useExportPhotos, usePhotos } from \"./model\";\nimport { Photos } from \"types/photos\";\nimport styled from \"@emotion/styled\";\nimport { ArtistSelect } from \"components/artistSelect\";\nimport { usePhotosParams, PhotoParamType } from \"./util\";\nimport { DownloadOutlined, ReloadOutlined } from \"@ant-design/icons\";\nimport { useEffect } from \"react\";\nconst GridContainer = ({\n  photos,\n  isLoading,\n}: {\n  photos: Photos[];\n  isLoading?: boolean;\n}) => {\n  return (\n    <Row gutter={[8, 8]}>\n      {isLoading ? (\n        <Spin size={\"large\"} />\n      ) : (\n        photos.map((photo) => (\n          <Col xs={24} sm={12} md={6} lg={4} key={photo.id}>\n            <CardContainer photo={photo} />\n          </Col>\n        ))\n      )}\n    </Row>\n  );\n};\n\nconst CardContainer = ({ photo }: { photo: Photos }) => {\n  const OSS_HOST = process.env.REACT_APP_OSS_URL;\n\n  return (\n    <Card\n      hoverable={true}\n      cover={\n        <ImageWrap>\n          <Image src={`${OSS_HOST}${photo.url}`} />\n        </ImageWrap>\n      }\n    >\n      <Space wrap={true}>\n        {photo.artists.map((artist) => (\n          <Tag key={artist.id}>{artist.name}</Tag>\n        ))}\n      </Space>\n    </Card>\n  );\n};\n\nconst ImageWrap = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  overflow: hidden;\n  height: 240px;\n`;\n\ninterface SearchPanelProps {\n  param: PhotoParamType;\n  setParam: (param: SearchPanelProps[\"param\"]) => void;\n}\n\nconst SearchContainer = ({ param, setParam }: SearchPanelProps) => {\n  const {\n    data: { url } = { url: \"\" },\n    mutateAsync: exportHandle,\n    isLoading,\n    status,\n  } = useExportPhotos();\n\n  useEffect(() => {\n    if (isLoading && status === \"loading\") {\n      message.loading({\n        content: \"当前【一键D爆】导出功能可能有点慢请见谅！\",\n        key: \"export\",\n      });\n    } else if (!isLoading && status === \"success\") {\n      // message.success({ content: \"Loaded!\", key: \"export\"});\n      notification.success({\n        message: \"您的DD大礼包已到！\",\n        duration: null,\n        btn: (\n          <Button\n            type=\"primary\"\n            size=\"small\"\n            onClick={() => {\n              window.location.href = url;\n            }}\n          >\n            下载\n          </Button>\n        ),\n      });\n    }\n  }, [isLoading, status, url]);\n\n  return (\n    <Row gutter={[8, 8]}>\n      <Col lg={2} xs={12}>\n        <Button\n          type={\"primary\"}\n          loading={isLoading}\n          onClick={() =>\n            exportHandle({ artistIds: param?.options?.artistIds || [] })\n          }\n          block\n          icon={<DownloadOutlined />}\n        >\n          一键D爆！\n        </Button>\n      </Col>\n      <Col lg={20} xs={12}>\n        <ArtistSelect\n          style={{ width: \"100%\" }}\n          value={param?.options?.artistIds || []}\n          onChange={(values) =>\n            setParam({\n              ...param,\n              options: { isAudit: true, artistIds: values },\n            })\n          }\n        />\n      </Col>\n    </Row>\n  );\n};\n\nexport const PhotosScreen = () => {\n  const [param, setParam] = usePhotosParams({\n    limit: 12,\n    skip: 0,\n    options: {\n      isAudit: true,\n      artistIds: [],\n    },\n  });\n\n  const { data: photos = [], isLoading, status } = usePhotos(param);\n\n  useEffect(() => {\n    if (status === \"success\" && param.limit > 12) {\n      window.location.href =\n        window.location +\n        (window.location.toString().includes(\"#Btn\") ? \"\" : \"#Btn\");\n    }\n  }, [status, param]);\n\n  return (\n    <>\n      <Row gutter={[8, 8]}>\n        <Col span={24}>\n          <SearchContainer param={param} setParam={setParam} />\n        </Col>\n        <Col span={24}>\n          <GridContainer photos={photos} />\n        </Col>\n        <Col span={24}>\n          <Button\n            id={\"Btn\"}\n            type=\"link\"\n            loading={isLoading}\n            onClick={() => {\n              setParam((pre) => ({\n                ...param,\n                limit: Number(pre.limit) + 12,\n              }));\n            }}\n            block\n            icon={<ReloadOutlined />}\n          >\n            {isLoading ? \"Loading\" : \"加载更多！もっともっと！\"}\n          </Button>\n        </Col>\n      </Row>\n    </>\n  );\n};\n","import { Button, Card, Col, Image, message, Row, Spin, Typography } from \"antd\";\nimport {\n  CloseCircleOutlined,\n  CheckCircleOutlined,\n  ReloadOutlined,\n} from \"@ant-design/icons\";\nimport { ArtistSelect } from \"components/artistSelect\";\nimport { useAuditPhotos, usePhotos } from \"./model\";\nimport { Photos } from \"types/photos\";\nimport styled from \"@emotion/styled\";\nimport {\n  useCardImageSelect,\n  useDeletePhotosHandle,\n  usePhotosParams,\n  usePhotosQueryKey,\n} from \"./util\";\nimport { useEffect } from \"react\";\nimport { useAuth } from \"context/authContext\";\n\ntype BatchSelectProps = {\n  selectArtistsIds: number[][];\n  handleSetSelectArtistsIds: (ids: number[], index: number) => void;\n  deletePhotosHandle: (id: number) => void;\n};\n\nconst CardContainer = ({\n  photo,\n  photoIdx,\n  selectArtistsIds,\n  handleSetSelectArtistsIds,\n  deletePhotosHandle,\n}: { photo: Photos; photoIdx: number } & BatchSelectProps) => {\n  const OSS_HOST = process.env.REACT_APP_OSS_URL;\n\n  return (\n    <Card\n      hoverable={true}\n      cover={\n        <ImageWrap>\n          <Image src={`${OSS_HOST}${photo.url}`} />\n        </ImageWrap>\n      }\n      actions={[\n        <CloseCircleOutlined onClick={() => deletePhotosHandle(photo.id)} />,\n        <CheckCircleOutlined />,\n      ]}\n    >\n      <Typography.Text>{photo.description}</Typography.Text>\n      <ArtistSelect\n        style={{ width: \"100%\" }}\n        value={selectArtistsIds[photoIdx]}\n        onChange={(val) => handleSetSelectArtistsIds(val, photoIdx)}\n      />\n    </Card>\n  );\n};\n\nconst GridContainer = ({\n  photos,\n  selectArtistsIds,\n  handleSetSelectArtistsIds,\n  deletePhotosHandle,\n}: { photos: Photos[] } & BatchSelectProps) => {\n  return (\n    <Row gutter={[8, 8]}>\n      {photos.map((photo, photoIdx) => (\n        <Col xs={24} sm={12} md={6} lg={4} key={photo.id}>\n          <CardContainer\n            photo={photo}\n            photoIdx={photoIdx}\n            selectArtistsIds={selectArtistsIds}\n            handleSetSelectArtistsIds={handleSetSelectArtistsIds}\n            deletePhotosHandle={deletePhotosHandle}\n          />\n        </Col>\n      ))}\n    </Row>\n  );\n};\n\nconst ImageWrap = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  overflow: hidden;\n  height: 240px;\n`;\n\nexport const WaitAuditPhotosScreen = () => {\n  const [param, setParam] = usePhotosParams({\n    limit: 12,\n    skip: 0,\n    options: {\n      isAudit: false,\n    },\n  });\n\n  const { data: photos = [], status, isLoading: gettingLoading } = usePhotos(\n    param\n  );\n\n  // 最底部\n  useEffect(() => {\n    if (status === \"success\" && param.limit > 12) {\n      window.location.href =\n        window.location +\n        (window.location.toString().includes(\"#Btn\") ? \"\" : \"#Btn\");\n    }\n  }, [status, param]);\n\n  // 下拉框\n  const [selectArtistsIds, handleSetSelectArtistsIds] = useCardImageSelect(\n    photos\n  );\n\n  // 删除\n  const deletePhotosHandle = useDeletePhotosHandle(param);\n  // 登录信息\n  const { user } = useAuth();\n\n  // 审核\n  const { mutateAsync, isLoading: editingLoading } = useAuditPhotos(\n    usePhotosQueryKey(param)\n  );\n  const handleAudit = async () => {\n    if (!user) {\n      message.error(\"没有权限哟~\");\n      return;\n    }\n    const auditList = photos\n      .map((photo, photoIdx) => ({\n        id: photo.id,\n        artistIds: selectArtistsIds[photoIdx],\n      }))\n      .filter((list) => list.artistIds.length > 0);\n\n    if (auditList.length === 0) {\n      message.warning(\"没有一个能审核的！\");\n      return;\n    }\n\n    mutateAsync(auditList);\n  };\n\n  return (\n    <>\n      <Row gutter={[8, 8]}>\n        <Col span={24}>\n          <Button type={\"primary\"} onClick={handleAudit}>\n            一键审核\n          </Button>\n        </Col>\n        <Col span={24}>\n          {editingLoading ? (\n            <Spin size=\"large\" />\n          ) : (\n            <GridContainer\n              photos={photos}\n              selectArtistsIds={selectArtistsIds}\n              handleSetSelectArtistsIds={handleSetSelectArtistsIds}\n              deletePhotosHandle={deletePhotosHandle}\n            />\n          )}\n        </Col>\n        <Col span={24}>\n          <Button\n            id={\"Btn\"}\n            type=\"link\"\n            loading={gettingLoading}\n            onClick={() => {\n              setParam((pre) => ({ ...param, limit: Number(pre.limit) + 12 }));\n            }}\n            block\n            icon={<ReloadOutlined />}\n          >\n            {gettingLoading ? \"Loading\" : \"加载更多！もっともっと！\"}\n          </Button>\n        </Col>\n      </Row>\n    </>\n  );\n};\n","import { useUrlQueryParam } from \"utils/url\";\n/**\n * 登录模态框\n */\nexport const useLoginModal = () => {\n  // 从url获取参数\n  const [{ login }, setLogin] = useUrlQueryParam([\"login\"]);\n\n  const open = () => setLogin({ login: true });\n  const close = () => setLogin({ login: \"\" });\n\n  return {\n    loginModalOpen: login === \"true\",\n    open,\n    close,\n  };\n};\n","import { Typography } from \"antd\";\n\n// 类型守卫\nconst isError = (value: any): value is string => value;\n\nexport const ErrorBox = ({ error }: { error: unknown }) => {\n  if (isError(error)) {\n    return <Typography.Text type={\"danger\"}>{error}</Typography.Text>;\n  }\n  return null;\n};\n","import { Form, Drawer, Row, Input, Button, Spin, Col, Space } from \"antd\";\nimport { useForm } from \"antd/lib/form/Form\";\nimport { ErrorBox } from \"components/lib\";\nimport { useAuth } from \"context/authContext\";\nimport { useEffect } from \"react\";\nimport { useLoginModal } from \"./util\";\n\nexport const LoginModal = () => {\n  const { loginModalOpen, close } = useLoginModal();\n\n  // // 更新数据\n  const { mutateAsync, isLoading: mutateLoading, error } = useAuth().useLogin();\n\n  const [form] = useForm();\n\n  // 关闭模态框\n  const closeModal = () => {\n    form.resetFields();\n    close();\n  };\n\n  // 提交表单\n  const onFinish = (values: any) => {\n    mutateAsync({\n      ...values,\n    }).then(() => {\n      closeModal();\n    });\n  };\n\n  // 设置初始化值\n  useEffect(() => {\n    form.setFieldsValue({ username: \"\", password: \"\" });\n  }, [form]);\n\n  return (\n    <Drawer\n      forceRender={true}\n      title={\"登录\"}\n      placement=\"left\"\n      onClose={closeModal}\n      width={\"100%\"}\n      visible={loginModalOpen}\n    >\n      {mutateLoading ? (\n        <Spin size={\"large\"} />\n      ) : (\n        <Row gutter={[16, 16]}>\n          <Col xs={24} lg={8}>\n            <Form form={form} layout={\"vertical\"} onFinish={onFinish}>\n              <Form.Item\n                name={\"username\"}\n                rules={[{ required: true, message: \"请输入用户名\" }]}\n              >\n                <Input placeholder={\"用户名\"} type=\"text\" id={\"username\"} />\n              </Form.Item>\n              <Form.Item\n                name={\"password\"}\n                rules={[{ required: true, message: \"请输入密码\" }]}\n              >\n                <Input placeholder={\"密码\"} type=\"password\" id={\"password\"} />\n              </Form.Item>\n              <Form.Item style={{ textAlign: \"right\" }}>\n                <Space>\n                  <ErrorBox error={error} />\n                  <Button\n                    loading={mutateLoading}\n                    type={\"primary\"}\n                    htmlType={\"submit\"}\n                  >\n                    登录\n                  </Button>\n                </Space>\n              </Form.Item>\n            </Form>\n          </Col>\n        </Row>\n      )}\n    </Drawer>\n  );\n};\n","import { BackTop, Button, Layout, Menu } from \"antd\";\nimport {\n  UserOutlined,\n  TeamOutlined,\n  HeartOutlined,\n  UsergroupAddOutlined,\n} from \"@ant-design/icons\";\nimport { Navigate, Route, Routes, useLocation } from \"react-router\";\nimport { BrowserRouter as Router, Link } from \"react-router-dom\";\nimport { ArtistsScreen } from \"screens/artists\";\nimport { PhotosScreen } from \"screens/photos\";\nimport { WaitAuditPhotosScreen } from \"screens/photos/waitAuditPhotos\";\nimport { useEffect } from \"react\";\nimport { useLoginModal } from \"./util\";\nimport { LoginModal } from \"./login\";\nimport { useAuth } from \"context/authContext\";\n\nconst useRouteType = () => {\n  const units = useLocation().pathname.split(\"/\");\n  return units[units.length - 1];\n};\n\nconst Sider = () => {\n  const routeType = useRouteType();\n\n  const { open } = useLoginModal();\n\n  const { user } = useAuth();\n\n  return (\n    <Layout.Sider breakpoint=\"lg\" collapsedWidth=\"0\">\n      <div style={{ padding: \"24px\" }}>\n        <Button\n          style={{ color: \"rgb(0, 170, 166)\" }}\n          type={\"link\"}\n          size={\"large\"}\n          onClick={open}\n          icon={<UserOutlined />}\n        >\n          {user ? user.username : \"？\"}\n        </Button>\n      </div>\n\n      <LoginModal />\n\n      <Menu theme=\"dark\" mode=\"inline\" selectedKeys={[routeType]}>\n        <Menu.Item key=\"photos\" icon={<HeartOutlined />}>\n          <Link to={\"photos\"}>DD区</Link>\n        </Menu.Item>\n        <Menu.Item key=\"artists\" icon={<TeamOutlined />}>\n          <Link to={\"artists\"}>声优</Link>\n        </Menu.Item>\n        <Menu.Item key=\"audit\" icon={<UsergroupAddOutlined />}>\n          <Link to={\"photos/audit\"}>审核区</Link>\n        </Menu.Item>\n      </Menu>\n    </Layout.Sider>\n  );\n};\n\nconst Container = () => {\n  return (\n    <Layout.Content style={{ margin: \"24px 24px 0\", display: \"flex\" }}>\n      <div style={{ padding: 24, backgroundColor: \"white\", flex: 1 }}>\n        <Routes>\n          <Route path={\"/artists\"} element={<ArtistsScreen />}></Route>\n          <Route path={\"/photos\"} element={<PhotosScreen />}></Route>\n          <Route\n            path={\"/photos/audit\"}\n            element={<WaitAuditPhotosScreen />}\n          ></Route>\n          <Navigate to={window.location.pathname + \"/photos\"} />\n\n          <BackTop />\n        </Routes>\n      </div>\n    </Layout.Content>\n  );\n};\n\nconst Footer = () => {\n  return (\n    <Layout.Footer style={{ textAlign: \"center\" }}>\n      声优DD区 ©2021 Created by Carl\n    </Layout.Footer>\n  );\n};\n\nconst Main = () => {\n  return (\n    <Layout style={{ minHeight: \"100vh\" }}>\n      <Container />\n      <Footer />\n    </Layout>\n  );\n};\n\nexport const IndexScreen = () => {\n  useEffect(() => {\n    document.title = \"人之初 性本D 誰でも大好き\";\n  }, []);\n\n  return (\n    <Layout>\n      <Router>\n        <Sider />\n        <Main />\n      </Router>\n    </Layout>\n  );\n};\n","import { IndexScreen } from \"./screens/index\";\nimport \"./App.css\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <IndexScreen />\n    </div>\n  );\n}\n\nexport default App;\n","import { ReactNode } from \"react\";\nimport { QueryClient, QueryClientProvider } from \"react-query\";\nimport { AuthProvider } from \"./authContext\";\n\nexport const AppProviders = ({ children }: { children: ReactNode }) => {\n  const queryClient = new QueryClient();\n  return (\n    <QueryClientProvider client={queryClient}>\n      <AuthProvider>{children}</AuthProvider>\n    </QueryClientProvider>\n  );\n};\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport App from \"./App\";\nimport \"antd/dist/antd.css\";\nimport { AppProviders } from \"context\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <AppProviders>\n      <App />\n    </AppProviders>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}